package mappingv1_test

import (
	. "github.com/jmalloc/motif/internal/crypto/mappingv1"
	. "github.com/onsi/ginkgo/v2"
	. "github.com/onsi/gomega"
)

var _ = Describe("func ComputeHash()", func() {
	It("returns an SHA-256 hash", func() {
		h := ComputeHash([]byte("<data>"))
		Expect(h).To(Equal(
			Hash{
				0xa1, 0x43, 0x3d, 0x50, 0x90, 0xb1, 0x13, 0x1f,
				0xf8, 0x75, 0x84, 0x0c, 0x66, 0x7a, 0x05, 0xe2,
				0x9c, 0xf4, 0xc3, 0x7c, 0x17, 0x5e, 0x2a, 0xc1,
				0x42, 0xd1, 0xdd, 0x17, 0x10, 0x16, 0x5a, 0x5f,
			},
		))
	})
})

var _ = Describe("func ComputeHMAC()", func() {
	It("returns an SHA-256 hash", func() {
		mac := ComputeHMAC([]byte("<key>"), []byte("<data>"))
		Expect(mac).To(Equal(
			Hash{
				0x0c, 0x31, 0x31, 0xaf, 0xbe, 0x2e, 0x05, 0x22,
				0x3a, 0x6e, 0xfe, 0x23, 0x80, 0x34, 0xcc, 0xa4,
				0x30, 0xf0, 0x1a, 0xf8, 0x07, 0x73, 0xa8, 0x00,
				0x83, 0xb5, 0x64, 0xf3, 0x85, 0x3c, 0xc7, 0x77,
			},
		))
	})
})
